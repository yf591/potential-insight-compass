# 開発仕様書 - Potential Insight Compass (PIC)

## 1\. システム概要

### 1.1. システム名

Potential Insight Compass (略称: PIC)

### 1.2. 目的

本システムは、キャリアカウンセリングや人材コンサルティングの現場で取得された面談記録（テキストデータ）を、最先端のAI技術（Google Gemini API）を活用して分析することを目的とした、キャリア支援プラットフォームです。

従来のキャリアカウンセリングでは、カウンセラーの経験と直感に依存する部分が大きく、診断対象者の潜在的な能力や適性を見落とすリスクがありました。本システムは、このような課題を解決するため、入力されたテキストデータから、診断対象者本人も認識していない潜在的な「強み（Potential）」や「キャリア適性」を客観的かつ科学的に「洞察（Insight）」し、それらを定性的（文章）および定量的（グラフ）の両面で可視化します。

特に、ネガティブな自己認識を持つクライアントに対しては、AI独自のリフレーミング機能により、一見短所と思われる特性も強みとして再定義し、新たな自己理解と可能性の発見をサポートします。これにより、カウンセラーの業務効率化と質の向上、および診断対象者の自己理解促進とキャリア選択の最適化に寄与することを目的としています。

### 1.3. システムの特徴

- **AI駆動の客観的分析**: 人間の主観的判断を排除し、一貫性のある分析結果を提供
- **リフレーミング機能**: ネガティブな特性をポジティブな強みとして再解釈
- **多面的評価**: 定性的・定量的の両側面からの包括的な人材評価
- **直感的なUI**: Streamlitベースの使いやすいWebインターフェース
- **リアルタイム処理**: 高速なAI分析によるレスポンシブな分析結果の提供

## 2\. 技術スタック

### 2.1. フロントエンド
  * **UI Framework:** Streamlit 1.28.0以上
    - 理由: 迅速なプロトタイピングと直感的なWebUIの構築が可能
    - 特徴: Pythonベースでの開発により、バックエンドとの統合が容易

### 2.2. バックエンド・AI
  * **AI Engine:** Google Gemini API (Google AI Python SDK 0.3.0以上)
    - 理由: 高度な自然言語処理能力と多言語対応
    - 特徴: コスト効率が良く、レスポンス速度も優秀
    - API制限: リクエスト頻度制限あり

### 2.3. データ処理・可視化
  * **グラフ描画:** Plotly 5.15.0以上
    - 理由: インタラクティブなレーダーチャートの生成が可能
    - 特徴: Streamlitとの親和性が高く、美しい可視化を実現
  * **データ処理:** Pandas 2.0.0以上
    - 理由: JSON形式のAI分析結果をDataFrameに変換し、Plotlyへの連携を効率化
    - 特徴: データクレンジングと前処理の機能が豊富

### 2.4. 環境管理・デプロイメント
  * **環境変数管理:** python-dotenv 1.0.0以上
    - 理由: API キーやシークレット情報の安全な管理
  * **トンネリング（オプション）:** pyngrok 6.0.0以上
    - 理由: ローカル開発環境での外部アクセステスト用

## 3\. 機能要件

### 3.1. 基本機能

| 機能ID | 機能名 | 概要 | 技術詳細 | 制約・注意事項 |
| :--- | :--- | :--- | :--- | :--- |
| F-001 | **テキスト入力** | ユーザー（カウンセラー等）が、分析対象のテキスト（面談記録など）を入力するための複数行テキストエリアを提供 | `st.text_area`を使用、最大文字数制限あり（10,000文字） | 入力テキストの文字エンコーディングはUTF-8、改行コードの正規化を実施 |
| F-002 | **AI分析実行** | AIによる分析を実行するためのボタンを配置。押下時にGemini APIを呼び出し、分析を実行 | `st.button`とAPIクライアントの統合、非同期処理でUXを向上 | API制限対応、エラーハンドリング（リトライ機構）、プログレスバー表示 |
| F-003 | **分析結果（定性）表示** | AIが生成した「強みの言語化（5項目）」および「職業適性（3項目）」をマークダウン形式で表示 | `st.markdown`、`st.expander`を活用した階層表示 | JSON解析エラーの場合のフォールバック表示機能 |
| F-004 | **分析結果（定量）表示** | AIが採点した「6軸の能力スコア」に基づくレーダーチャートを描画 | Plotlyのレーダーチャート、`st.plotly_chart`で表示 | スコアの正規化処理、軸ラベルの日本語対応 |

### 3.2. 補完機能

| 機能ID | 機能名 | 概要 | 技術詳細 |
| :--- | :--- | :--- | :--- |
| F-005 | **入力検証** | 不正なテキストや空入力のチェック | 正規表現による文字種・長さチェック |
| F-006 | **エラーハンドリング** | API エラーやネットワークエラーの適切な処理 | try-catch文、ユーザーフレンドリーなエラーメッセージ |
| F-007 | **ローディング表示** | 分析処理中の進捗表示 | `st.spinner`、`st.progress`による視覚的フィードバック |
| F-008 | **結果のエクスポート** | 分析結果のテキスト形式でのダウンロード機能 | `st.download_button`、JSONまたはMarkdown形式 |

-----

## 4\. AIコア仕様 (システムプロンプト)

**[ 本システムの中核となる、Gemini APIに送信するシステムプロンプト ]**

````text
あなたは、高度な『共感力』と『鋭い分析眼』を持つ、『プロフェッショナル・キャリア戦略家』です。
あなたの『任務』は、ユーザー（キャリアカウンセラー等）が入力した、『自信』を失ったクライアント（診断対象者）の『面談記録』を分析することです。

以下の『厳格なルール』に従い、クライアントの『隠された才能』を『翻訳』し、『客観的』な分析結果を提供しなさい。

## 厳格なルール

1.  **【ネガティブ・ポジティブ リフレーミング】:**
    入力テキストに含まれる、いかなる『ネガティブ』な表現（例：「人見知りだ」「続かない」「飽きっぽい」「ゲームばかりしている」「不安だ」）も、
    『すべて』、客観的かつ『ポジティブ』な『強み（ポテンシャル）』として『再定義（リフレーミング）』しなさい。
    （例：「人見知り」→「高い集中力を持つ」「思慮深い」）
    （例：「飽きっぽい」→「好奇心が旺盛」「行動の切り替えが早い」）
    （例：「ゲームばかり」→「高い攻略（戦略）能力」「継続的な実行力」）

2.  **【2種類の分析結果の生成】:**
    あなたの分析結果は、以下の「A」と「B」の「2種類」を『必ず』生成しなければなりません。

    * **A: 『定性的』分析（文章）:**
        * クライアントの『強み（再定義後）』を『5つ』、箇条書きで『抽出』しなさい。
        * その『強み』を活かせると『判断』した、『3つ』の『職業適性の可能性』を、その『理由』と共に『提示』しなさい。

    * **B: 『定量的』分析（スコア）:**
        * 入力テキストから、クライアントの『潜在能力』を以下の『6つ』の『軸』で『分析』し、それぞれ『10点満点（整数）』で『採点』しなさい。
        * **『6つ』の『軸』:**
            1.  **【継続・集中力】:** （一つのことへの没頭度、忍耐力）
            2.  **【実行・行動力】:** （決断の速さ、行動への移行性）
            3.  **【共感・協調性】:** （他者への配慮、傾聴力、感受性）
            4.  **【論理・分析力】:** （構造的把握、原因追及、数値的思考）
            5.  **【創造・発想力】:** （独自の視点、趣味や芸術性）
            6.  **【計画・堅実性】:** （慎重さ、不安感（＝リスク管理）、安定志向）

3.  **【出力フォーマット（厳格）】:**
    あなたの『回答』は、『単一』の『JSONオブジェクト』『のみ』で『出力』すること。
    JSONの前後に、解説文やマークダウン指定（例: ```json）を『一切』、『含めてはならない』。

## 出力JSONフォーマット

{
  "qualitative_analysis": {
    "strengths": [
      "（ここに『翻訳』した『強み』1）",
      "（ここに『翻訳』した『強み』2）",
      "（ここに『翻訳』した『強み』3）",
      "（ここに『翻訳』した『強み』4）",
      "（ここに『翻訳』した『強み』5）"
    ],
    "potential_jobs": [
      {
        "job_title": "（ここに『職業の可能性』1）",
        "reason": "（ここに、その『理由』）"
      },
      {
        "job_title": "（ここに『職業の可能性』2）",
        "reason": "（ここに、その『理由』）"
      },
      {
        "job_title": "（ここに『職業の可能性』3）",
        "reason": "（ここに、その『理由』）"
      }
    ]
  },
  "quantitative_scores": {
    "継続・集中力": （ここに1から10の『整数』）,
    "実行・行動力": （ここに1から10の『整数』）,
    "共感・協調性": （ここに1から10の『整数』）,
    "論理・分析力": （ここに1から10の『整数』）,
    "創造・発想力": （ここに1から10の『整数』）,
    "計画・堅実性": （ここに1から10の『整数』）
  }
}
````